@using JIC.Crime.View.Models
@model  MinutesOfSessionCreateViewModel

@using (Ajax.BeginForm("Index", new AjaxOptions { HttpMethod = "Post", UpdateTargetId = "Indexdiv" }))
{
    @Html.AntiForgeryToken()

    <div class="row">
        <div class="col-xs-12">
            <div class="col-xs-4">
                <h4>جلسة (@Model.SessionData.SessionDate.ToShortDateString()) </h4>
            </div>

        </div>
    </div>
    <div class="panel panel-primary">
        <div class="panel-heading">
            @JIC.Base.Resources.Resources.CaseParties
        </div>
        <div class="panel-body">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    @JIC.Base.Resources.Resources.Defendants
                </div>
                <div class="panel-body">

                    @Html.Label((Model.CaseDefectsData.Count).ToString() + " متهم ")

                    @(Html
                                                                                                                                                                                       .Grid(Model.CaseDefectsData.AsEnumerable())
                                                                                                                                                                                       .Build(columns =>
                                                                                                                                                                                       {
                                                                                                                                                                                           columns.Add(model => model.Order).Titled(JIC.Base.Resources.Resources.number);

                                                                                                                                                                                           columns.Add(model => Html.DropDownList("AttendenceType", model.AtendanceType, "إختار....", new { @class = "form-control" }).ToString() + new MvcHtmlString("<span class='hidden' id='Defendent' style='color: red'>هذا الحقل مطلوب</span>").ToString() + Html.Hidden("DefectID", model.ID) + Html.Hidden("DefectType", model.DefectType)).Encoded(false).Titled(JIC.Base.Resources.Resources.PresenceStatusInSession);
                                                                                                                                                                                           columns.Add(model => model.Name).Titled(JIC.Base.Resources.Resources.Name);
                                                                                                                                                                                           columns.Add(model => model.Nationality).Titled(JIC.Base.Resources.Resources.Nationality);
                                                                                                                                                                                           columns.Add(model => model.NationalID==null ? model.PassportNumber:model.NationalID).Titled(JIC.Base.Resources.Resources.NationalId);
                                                                                                                                                                                           //columns.Add(model => model.Birthdate).Titled(JIC.Base.Resources.Resources.Birthday);
                                                                                                                                                                                           columns.Add(model => model.Age.ToString()).Titled(JIC.Base.Resources.Resources.Age);
                                                                                                                                                                                           columns.Add(model => model.JobName).Titled(JIC.Base.Resources.Resources.Job);
                                                                                                                                                                                           //  columns.Add(model => model.PassportNumber).Titled(JIC.Base.Resources.Resources.PassportNo);
                                                                                                                                                                                           columns.Add(model => model.Address).Titled(JIC.Base.Resources.Resources.Address);

                                                                                                                                                                                       }).RowCss(row => "Defendent")

                    )


                </div>
            </div>

            <div class="panel panel-primary">
                <div class="panel-heading">
                    @JIC.Base.Resources.Resources.Victims
                </div>
                <div class="panel-body">
                    @Html.Label((Model.CaseVictims.Count).ToString() + " مجنى عليه ")





                    @(Html
                                                                                                                                                                          .Grid(Model.CaseVictims.AsEnumerable())
                                                                                                                                                                          .Build(columns =>
                                                                                                                                                                          {
                                                                                                                                                                              columns.Add(model => model.Order).Titled(JIC.Base.Resources.Resources.number);

                                                                                                                                                                              columns.Add(model => Html.DropDownList("AttendenceType", model.AtendanceType, "إختار....", new { @class = "form-control" }).ToString() + new MvcHtmlString("<span class='hidden' id='Victims' style='color: red'>هذا الحقل مطلوب</span>").ToString() + Html.Hidden("DefectID", model.ID) + Html.Hidden("DefectType", model.DefectType)).Encoded(false).Titled(JIC.Base.Resources.Resources.PresenceStatusInSession);
                                                                                                                                                                              columns.Add(model => model.Name).Titled(JIC.Base.Resources.Resources.Name);
                                                                                                                                                                              columns.Add(model => model.Nationality).Titled(JIC.Base.Resources.Resources.Nationality);
                                                                                                                                                                              columns.Add(model => model.NationalID == null ? model.PassportNumber : model.NationalID).Titled(JIC.Base.Resources.Resources.NationalId);
                                                                                                                                                                              //columns.Add(model => model.Birthdate).Titled(JIC.Base.Resources.Resources.Birthday);
                                                                                                                                                                              columns.Add(model => model.Age.ToString()).Titled(JIC.Base.Resources.Resources.Age);
                                                                                                                                                                              columns.Add(model => model.JobName).Titled(JIC.Base.Resources.Resources.Job);
                                                                                                                                                                              //  columns.Add(model => model.PassportNumber).Titled(JIC.Base.Resources.Resources.PassportNo);
                                                                                                                                                                              columns.Add(model => model.Address).Titled(JIC.Base.Resources.Resources.Address);

                                                                                                                                                                          }).RowCss(row => "Victims")

                    )
                </div>
            </div>


            @*----------------------------------- الشهود ----------------------------------------*@


            <div class="panel panel-primary">
                <div class="panel-heading">
                    @JIC.Base.Resources.Resources.Witnesses
                </div>
                <div class="panel-body">
                    @Html.Label((Model.CaseWitnesses.Count).ToString() + " شهود ")


                    @(Html
.Grid(Model.CaseWitnesses.AsEnumerable())
.Build(columns =>
{
    columns.Add(model => model.Order).Titled(JIC.Base.Resources.Resources.number);
    columns.Add(model => Html.DropDownList("AttendenceType", model.AtendanceType, "إختار....", new { @class = "form-control" }).ToString() + new MvcHtmlString("<span class='hidden' id='Victims' style='color: red'>هذا الحقل مطلوب</span>").ToString() + Html.Hidden("WitnessID", model.ID)).Encoded(false).Titled(JIC.Base.Resources.Resources.PresenceStatusInSession);
    //columns.Add(model => Html.DropDownList("AttendenceType", model.AtendanceType, "إختار....", new { @class = "form-control" }).ToString() + new MvcHtmlString("<span class='hidden' id='Victims' style='color: red'>هذا الحقل مطلوب</span>").ToString() + Html.Hidden("DefectID", model.ID) + Html.Hidden("DefectType", model.DefectType)).Encoded(false).Titled(JIC.Base.Resources.Resources.PresenceStatusInSession);
    columns.Add(model => model.Name).Titled(JIC.Base.Resources.Resources.Name);
    columns.Add(model => model.Nationality).Titled(JIC.Base.Resources.Resources.Nationality);
    columns.Add(model => model.NationalID == null ? model.PassportNumber : model.NationalID).Titled(JIC.Base.Resources.Resources.NationalId);
    columns.Add(model => model.Birthdate).Titled(JIC.Base.Resources.Resources.Birthday);
    columns.Add(model => model.Age.ToString()).Titled(JIC.Base.Resources.Resources.Age);
    columns.Add(model => model.JobName).Titled(JIC.Base.Resources.Resources.Job);
    columns.Add(model => model.PassportNumber).Titled(JIC.Base.Resources.Resources.PassportNo);
    columns.Add(model => model.Address).Titled(JIC.Base.Resources.Resources.Address);
})/*.RowCss(row => "Victims")*/

                    )
                </div>
            </div>
        </div>
    </div>
    <div class="row">

        <div class="col-sm-4">
            <input type="button" value="@JIC.Base.Resources.Resources.Save" onclick="GetObjectViewModel()" class="btn-default" />
        </div>
    </div>



}

@if (ViewBag.Saved != null && (bool)ViewBag.Saved)
{
    <script>
        debugger;
        $(document).trigger('Attendance:Saved');
    </script>
}